groups:
  - name: test
    rules:
    - record: metric:kubernetes_container_oom_killer
      expr: min_over_time(kube_pod_container_status_last_terminated_reason{reason="OOMKilled"}[10m])
  - name: alert-test
    rules:
    - alert: KubernetesContainerOomKiller
      expr: min_over_time(kube_pod_container_status_last_terminated_reason{reason="OOMKilled"}[10m]) > 0
      for: 0m
      labels:
        severity: warning
      annotations:
        summary: Kubernetes container oom killer (instance {{ $labels.instance }})
        description: "Container {{ $labels.container }} in pod {{ $labels.namespace }}/{{ $labels.pod }} has been OOMKilled {{ $value }} times in the last 10 minutes.\n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}"